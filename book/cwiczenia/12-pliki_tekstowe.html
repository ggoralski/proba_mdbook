<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Praca z plikami tekstowymi w linii komend - Próba mdbook</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body class="light">
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { } 
            if (theme === null || theme === undefined) { theme = default_theme; }
            document.body.className = theme;
            document.querySelector('html').className = theme + ' js';
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <ol class="chapter"><li><a href="../wyklady/02-Podstawy_filogenetyki.html"><strong aria-hidden="true">1.</strong> Wstęp do filogenetyki molekularnej i tworzenia drzew filogenetycznych</a></li><li><a href="../wyklady/03-Dopasowanie_sekwencji.html"><strong aria-hidden="true">2.</strong> Dopasowanie sekwencji</a></li><li><a href="../wyklady/04-Modele_ewolucji_molekularnej.html"><strong aria-hidden="true">3.</strong> Modele ewolucji molekularnej</a></li><li><a href="../wyklady/05-Drzewa_filogenetyczne.html"><strong aria-hidden="true">4.</strong> Drzewa filogenetyczne</a></li><li><a href="../wyklady/06-HGT.html"><strong aria-hidden="true">5.</strong> Horyzontalny transfer genów (HGT)</a></li><li><a href="../cwiczenia/11-praca_w_linuksie.html"><strong aria-hidden="true">6.</strong> Podstawy pracy w systemie Linux</a></li><li><a href="../cwiczenia/12-pliki_tekstowe.html" class="active"><strong aria-hidden="true">7.</strong> Praca z plikami tekstowymi w linii komend</a></li><li><a href="../cwiczenia/13-edytory_tekstu.html"><strong aria-hidden="true">8.</strong> Edytory tekstu</a></li><li><a href="../cwiczenia/14-skrypty.html"><strong aria-hidden="true">9.</strong> Skrypty powłoki</a></li><li><a href="../cwiczenia/15-warsztat.html"><strong aria-hidden="true">10.</strong> Warsztat pracy</a></li><li><a href="../cwiczenia/16-genbank-www.html"><strong aria-hidden="true">11.</strong> Bazy sekwencji DNA, GenBank</a></li><li><a href="../cwiczenia/17-genbank-cli.html"><strong aria-hidden="true">12.</strong> Pobieranie sekwencji z bazy GenBank i praca w plikami FASTA przy pomocy linii komend</a></li><li><a href="../cwiczenia/18-blast.html"><strong aria-hidden="true">13.</strong> BLAST - wyszukiwanie podobnych sekwencji</a></li><li><a href="../cwiczenia/19-dopasowanie_sekwencji.html"><strong aria-hidden="true">14.</strong> Dopasowanie sekwencji</a></li><li><a href="../cwiczenia/20-dopasowanie_modelu.html"><strong aria-hidden="true">15.</strong> Dopasowanie modelu substytucji</a></li><li><a href="../cwiczenia/21-konstruowanie-drzew.html"><strong aria-hidden="true">16.</strong> Konstruowanie drzew</a></li><li><a href="../cwiczenia/22-wizualizacja-drzew.html"><strong aria-hidden="true">17.</strong> Wizualizacja drzew</a></li><li><a href="../cwiczenia/23-zegar-molekularny.html"><strong aria-hidden="true">18.</strong> Drzewa filogenetyczne i zegar molekularny</a></li></ol>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar" class="menu-bar">
                    <div id="menu-bar-sticky-container">
                        <div class="left-buttons">
                            <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                                <i class="fa fa-bars"></i>
                            </button>
                            <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                                <i class="fa fa-paint-brush"></i>
                            </button>
                            <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                                <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                            </ul>
                            
                            <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                                <i class="fa fa-search"></i>
                            </button>
                            
                        </div>

                        <h1 class="menu-title">Próba mdbook</h1> 

                        <div class="right-buttons">
                            <a href="../print.html" title="Print this book" aria-label="Print this book">
                                <i id="print-button" class="fa fa-print"></i>
                            </a>
                            
                        </div>
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <p><a href="../README.html">← Spis treści</a></p>
<a class="header" href="#praca-z-plikami-tekstowymi-w-linii-komend" id="praca-z-plikami-tekstowymi-w-linii-komend"><h1>Praca z plikami tekstowymi w linii komend</h1></a>
<a class="header" href="#dlaczego-to-takie-ważne" id="dlaczego-to-takie-ważne"><h2>Dlaczego to takie ważne?</h2></a>
<p>Jak już wspominałem, praca bioinformatyka to w dużej mierze, o ile nie przede wszystkim praca z plikami tekstowymi. W <a href="11-praca_w_linuksie.html">poprzedniej lekcji</a> pokazałem jak umieścić tekst w pliku przy pomocy operatorów <code>&gt;</code> oraz <code>&gt;&gt;</code> a także jak wyświetlić zawartość pliku używając komend <code>more</code>, <code>less</code> i <code>cat</code>. Linux oferuje jednak znacznie więcej narzędzi pozwalających na efektywną pracę z plikami tekstowymi bez uciekania się do pomocy edytorów tekstu (na które też przyjdzie pora). Poniżej pokażę wybrane możliwości niektórych z nich. Warto jednak samodzielnie poszerzyć wiedzę na ten temat, ponieważ potrafią znacznie usprawnić i przyspieszyć pracę.</p>
<p>W terminalu utwórz katalog <code>Pliki_tekstowe</code> i wejdź do niego. Używając polecenia <code>curl</code> lub <code>wget</code> pobierz plik:</p>
<p><code>http://ggoralski.pl/files/filogenetyka-data/Orobanchaceae-trnL-trnF-aligned.fasta</code></p>
<a class="header" href="#liczenie-zawartości-i-wyświetlanie-części-pliku---polecenia-wc-head-tail" id="liczenie-zawartości-i-wyświetlanie-części-pliku---polecenia-wc-head-tail"><h2>Liczenie zawartości i wyświetlanie części pliku - polecenia <code>wc</code>, <code>head</code>, <code>tail</code>.</h2></a>
<p>Wykonaj polecenie:</p>
<pre><code>$: wc Orobanchaceae-trnL-trnF-aligned.fasta 
  18   18 9254 Orobanchaceae-trnL-trnF-aligned.fasta
</code></pre>
<p>Komenda <code>wc</code> wyświetla liczbę linii, słów oraz wielkość liczoną w bajtach podanego pliku. Podając odpowiednie flagi, można uzyskać tylko wybrane dane (sprawdź <code>wc --help</code>), co później wykorzystamy.
W przypadku pobranego pliku liczba linii i słów jest taka sama (18) ponieważ w opisach i sekwencjach nie występują spacje a sekwencje zostały umieszczone każda w jednej linii. Sprawdź zatem inny plik:</p>
<p><code>http://ggoralski.pl/files/filogenetyka-data/Orobanchaceae-trnL-trnF-aligned.aln</code></p>
<p>Zawiera on dopasowane sekwencje zapisane w formacie <code>CLUSTAL</code>. Zobacz jaka jest zawartość pliku a następnie sprawdź ile ma linii i słów.</p>
<p>Polecenie <code>wc</code> może odczytywać dane z wielu plików jednocześnie:</p>
<pre><code>$: wc *
  233   490 17672 Orobanchaceae-trnL-trnF-aligned.aln
   18    18  9254 Orobanchaceae-trnL-trnF-aligned.fasta
  251   508 26926 razem
</code></pre>
<p>Nie zawsze konieczne jest przeglądanie całego pliku. Czasem chcemy po prostu zobaczyć jak wygląda jego początek i koniec. Wtedy przychodzą nam z pomocą polecenia <code>head</code> i <code>tail</code>, które jak łatwo zgadnąć wyświetlają odpowiednio początek i koniec pliku:</p>
<pre><code>$: head Orobanchaceae-trnL-trnF-aligned.aln 
CLUSTAL 2.1 multiple sequence alignment


KY484464_O._teucrii                AGTTATAAC-TTTCAAATTCAGAGAAACCCCGGAATTAAGAGAAA-GGGC
KY484493_O._flava                  AGTGATAAC-TTTCAAATTCAGAGAAACCCCGGAATTAAGAAAAA-GGGC
KY484489_O._mayeri                 AGTGATAAC-TTTCAAATTCAGAGAAACCCCGGAATTAATAAAAA-GGGC
KY484471_O._kochii                 AGTGATAAC-TTTCAAATTCAGAGAAACCCCGGAATTAATAAAAA-GGGC
KY484474_O._elatior                AGTGATAAC-TTTCAAATTCAGAGAAACCCCGGAATTAATAAAAA-GGGC
KU238865_O._coerulescens           AGTGATAAC-TTTCAAATTCAGAGAAACCCCGGAATTAAGAAAAA-GGGC
KY484502_P._ramosa                 GGTGATAAC-TTTCAAATTCAGAGAAACTCCGGAATTAATAAAAACGGGC
$: tail Orobanchaceae-trnL-trnF-aligned.aln 
KY484464_O._teucrii                AAATG
KY484493_O._flava                  AAATG
KY484489_O._mayeri                 AAATG
KY484471_O._kochii                 AAATG
KY484474_O._elatior                AAATG
KU238865_O._coerulescens           GAATG
KY484502_P._ramosa                 GAATG
KY484503_P._purpurea               GAATG
KX524675_Lindenbergia_siniaca      GAATG
                                    ****
</code></pre>
<p>Liczbę wyświetlanych linii można dostosować używając flagi <code>-n</code>:</p>
<pre><code>$: head -n 5 Orobanchaceae-trnL-trnF-aligned.aln 
CLUSTAL 2.1 multiple sequence alignment


KY484464_O._teucrii                AGTTATAAC-TTTCAAATTCAGAGAAACCCCGGAATTAAGAGAAA-GGGC
KY484493_O._flava                  AGTGATAAC-TTTCAAATTCAGAGAAACCCCGGAATTAAGAAAAA-GGGC
$: tail -n 5 Orobanchaceae-trnL-trnF-aligned.aln 
KU238865_O._coerulescens           GAATG
KY484502_P._ramosa                 GAATG
KY484503_P._purpurea               GAATG
KX524675_Lindenbergia_siniaca      GAATG
                                    ****
</code></pre>
<a class="header" href="#grep---wyszukiwanie-w-pliku-tekstowym" id="grep---wyszukiwanie-w-pliku-tekstowym"><h2><code>grep</code> - wyszukiwanie w pliku tekstowym</h2></a>
<p>Narzędzie <code>grep</code> z pewnością należy do najbardziej użytecznych programów do pracy z plikami tekstowymi. Służy do wynajdywania w plikach danego ciągu znaków.</p>
<p>W katalogu z pobranymi (patrz wyżej) plikami wykonaj polecenie:</p>
<pre><code>$: grep Lindenbergia Orobanchaceae-trnL-trnF-aligned.fasta 
&gt;KX524675_Lindenbergia_siniaca
</code></pre>
<p>W podanym pliku został znaleziony ciąg znaków <code>Lindenbergia</code> a następnie linia w którym się znajdował została wyświetlona. Jeśli znaleziony fragment nie wyświetla się w innym kolorze niż pozostała część linii to można to uzyskać podając opcję <code>--color=AUTO</code>, np. <code>grep --color=AUTO Lindenbergia Orobanchaceae-trnL-trnF-aligned.fasta</code>.</p>
<p>Można przeszukać od razu wiele plików np. używając znaków wieloznacznych, uzyskamy także informację w jakim pliku znaleziono dopasowanie:</p>
<pre><code>$: grep Lindenbergia *          

Orobanchaceae-trnL-trnF-aligned.aln:KX524675_Lindenbergia_siniaca      AGTGATAAC-TTTCAAATTCAGAGAAACCCCGGAATTAAAAAAGG-GGGC
Orobanchaceae-trnL-trnF-aligned.aln:KX524675_Lindenbergia_siniaca      AATCCTGAGCCAAATCCTGT-----TTTCTCAAAACAAA-G--------A
Orobanchaceae-trnL-trnF-aligned.aln:KX524675_Lindenbergia_siniaca      C-AAAAATAAAGGATAGGTGCAGAGACTCAACGGAAGCTGTTCTAAC---
Orobanchaceae-trnL-trnF-aligned.aln:KX524675_Lindenbergia_siniaca      -AAATGGAGTTGATTGCGCCGGTAGAGGAATCTTTCCATCGAAACTTCGG
Orobanchaceae-trnL-trnF-aligned.aln:KX524675_Lindenbergia_siniaca      AAAGGATGAAGGATAAACGTATCTATTGAATACTATATCAAATTATTAAT
Orobanchaceae-trnL-trnF-aligned.aln:KX524675_Lindenbergia_siniaca      GATATCAAATTATTAATGATGGCCCGAATCTGTATCTGTATTTTT---TA
Orobanchaceae-trnL-trnF-aligned.aln:KX524675_Lindenbergia_siniaca      ATTTTAATATGAAAAATGGAAAAGTTAGTGTGAATTGATTCCATATTGAA
Orobanchaceae-trnL-trnF-aligned.aln:KX524675_Lindenbergia_siniaca      GAAAGAATCGAATATTCATT-------CATCAAATCATTCACTCCACAGT
Orobanchaceae-trnL-trnF-aligned.aln:KX524675_Lindenbergia_siniaca      CCGATAGATC-----TTTTAAAGAATTGATTAATCGGATGAGAATAAAGA
Orobanchaceae-trnL-trnF-aligned.aln:KX524675_Lindenbergia_siniaca      TAGAGTCCCATTC----------TACATGTCAATACCGGCAACAATGAAA
Orobanchaceae-trnL-trnF-aligned.aln:KX524675_Lindenbergia_siniaca      TTTATAGTAAGAGGAAAATCCGTCGACTTTAAAAATCGTGAGGGTTCAAG
Orobanchaceae-trnL-trnF-aligned.aln:KX524675_Lindenbergia_siniaca      TCCCTCTATCCCCAA---AAAAAGTCTATTTTACTTCCA-----------
Orobanchaceae-trnL-trnF-aligned.aln:KX524675_Lindenbergia_siniaca      -----------AAATATTTAGCCTATTTCA-----------------TTT
Orobanchaceae-trnL-trnF-aligned.aln:KX524675_Lindenbergia_siniaca      TCG-TTAGCGGTTCCAAATTCCTT--TTCTGATTC--TTTGACA--AACG
Orobanchaceae-trnL-trnF-aligned.aln:KX524675_Lindenbergia_siniaca      TATTGGGGCGT------------------AAATGACTTT-CTCTTATCAC
Orobanchaceae-trnL-trnF-aligned.aln:KX524675_Lindenbergia_siniaca      ATGTG------ATATAGAATACACATCCAAATTCAGCAAGGAATTCCTAT
Orobanchaceae-trnL-trnF-aligned.aln:KX524675_Lindenbergia_siniaca      TTGAATG------ATTCAGAATCAATAACATTACTC-AT-ACTGAAACTT
Orobanchaceae-trnL-trnF-aligned.aln:KX524675_Lindenbergia_siniaca      AGA---AAGTTCGTCTTTTTGAAGATCCAATAAATTACAGGATTTGGAGA
Orobanchaceae-trnL-trnF-aligned.aln:KX524675_Lindenbergia_siniaca      AAACTTTGTAATCTTCCCCA--TCCCTTTAATTGACATAGAGCCCAGTC-
Orobanchaceae-trnL-trnF-aligned.aln:KX524675_Lindenbergia_siniaca      ---ATCTAAT--AAAATCA------GGATGGGAATGGGATTATACATTGG
Orobanchaceae-trnL-trnF-aligned.aln:KX524675_Lindenbergia_siniaca      GAATG
Orobanchaceae-trnL-trnF-aligned.fasta:&gt;KX524675_Lindenbergia_siniaca
</code></pre>
<p>Jeśli chcemy przeszukać pliki w danym katalogu, należy użyć opcji <code>-r</code>, np.: <code>grep -r Lindenbergia SEKWENCJE</code>.</p>
<p>Narzędzia grep można użyć na przykład do sprawdzenia ile sekwencji znajduje się w pliku <code>fasta</code>. W tym celu należy znaleźć i policzyć linie zawierające znak <code>&gt;</code>. Tu jednak czyha pewna pułapka. Najbardziej oczywistą komendą wydaje się: <code>grep &gt; Orobanchaceae-trnL-trnF-aligned.fasta</code> ale jej wynik będzie taki:</p>
<pre><code>$: grep &gt; Orobanchaceae-trnL-trnF-aligned.fasta 
Składnia: grep [OPCJA]... WZORZEC [PLIK] ...
Napisz „grep --help” żeby dowiedzieć się więcej.
</code></pre>
<p>Po pierwsze polecenie ewidentnie nie zrobiło tego czego po nim oczekiwaliśmy a po drugie jeśli teraz spróbujemy wyświetlić zawartość pliku <code>Orobanchaceae-trnL-trnF-aligned.fasta</code> to okaże się, że jest pusty. Dlaczego?</p>
<p>Przypomnijmy sobie, że operator <code>&gt;</code> służy do przekazania tekstu do pliku. Zatem polecenie <code>grep &gt; Orobanchaceae-trnL-trnF-aligned.fasta</code> uruchomiło polecenie <code>grep</code> (z nieprawidłową składnią) a wynik jego działania zapisało w pliku, w którym chcieliśmy szukać znaków <code>&gt;</code>, wymazując jego poprzednią zawartość. Jest to bardzo łatwy do popełnienia błąd, który może się skończyć utratą wyników pracy! Jak więc należy prawidłowo wyszukać znaku <code>&gt;</code>? Umieszczając go w cudzysłowach:</p>
<pre><code>$: grep &quot;&gt;&quot; Orobanchaceae-trnL-trnF-aligned.fasta
&gt;KY484464_O._teucrii
&gt;KY484493_O._flava
&gt;KY484489_O._mayeri
&gt;KY484471_O._kochii
&gt;KY484474_O._elatior
&gt;KU238865_O._coerulescens
&gt;KY484502_P._ramosa
&gt;KY484503_P._purpurea
&gt;KX524675_Lindenbergia_siniaca
</code></pre>
<blockquote>
<p>Zadanie: Zastanów się, co trzeba zrobić, żeby uzyskać nazwy sekwencji w osobnym pliku?</p>
</blockquote>
<p>No dobrze, teraz możemy policzyć wyświetlone linie ale wolelibyśmy, żeby komputer sam je policzył. Co prawda istnieje odpowiednia opcja programu <code>grep</code>, która to robi (znajdź ją), ale jest to dobra okazja, żeby pokazać w jaki sposób można połączyć różne polecenia tak aby wykonały razem zadanie.</p>
<a class="header" href="#potoki-czyli-łączymy-polecenia" id="potoki-czyli-łączymy-polecenia"><h2>Potoki, czyli łączymy polecenia.</h2></a>
<p>Chcemy policzyć linie, w których znajduje się znak <code>&gt;</code>. Mamy do dyspozycji jedno narzędzie, które wyszukuje odpowiednie linie (<code>grep</code>) i drugie, które liczy linie (<code>wc</code>). Trzeba je zatem odpowiednio połączyć w jeden ,,taśmociąg''. Wykorzystamy do tego potoki (ang. <em>pipe</em>) - wynik działania <code>grep</code> (strumień) zostanie skierowany do <code>wc</code>. Do łączenia w ten sposób poleceń służy operator <code>|</code>. Polecenia <code>wc</code> użyjemy z flagą <code>-l</code>, która zwraca liczbę linii.</p>
<pre><code>$: grep &quot;&gt;&quot; Orobanchaceae-trnL-trnF-aligned.fasta | wc -l
9
</code></pre>
<p>Wiemy, że w pliku mamy 9 sekwencji.</p>
<p>Teraz poznamy kolejną opcję <code>-v</code>, która pozwala ,,odwrócić'' dopasowanie, czyli zwrócić linie, w których <strong>nie występuje</strong> dopasowanie i połączymy dwa polecenia <code>grep</code> tak, aby uzyskać listę próbek, które <strong>nie zawierają</strong> ciągu ,,Lindenbergia'':</p>
<pre><code>$: grep -v Lindenbergia Orobanchaceae-trnL-trnF-aligned.fasta | grep &quot;&gt;&quot;
&gt;KY484464_O._teucrii
&gt;KY484493_O._flava
&gt;KY484489_O._mayeri
&gt;KY484471_O._kochii
&gt;KY484474_O._elatior
&gt;KU238865_O._coerulescens
&gt;KY484502_P._ramosa
&gt;KY484503_P._purpurea
</code></pre>
<p>Jak widać, w drugim wywołaniu plecenia <code>grep</code> nie podaliśmy nazwy pliku, tekst do przeanalizowania został przekazany za pomocą potoku.</p>
<p>Wynik możemy przekazać dalej, na przykład do polecenia <code>sort</code>, które jak nazwa wskazuje sortuje linie tekstu:</p>
<pre><code>$: grep -v Lindenbergia Orobanchaceae-trnL-trnF-aligned.fasta | grep &quot;&gt;&quot; | sort
&gt;KU238865_O._coerulescens
&gt;KY484464_O._teucrii
&gt;KY484471_O._kochii
&gt;KY484474_O._elatior
&gt;KY484489_O._mayeri
&gt;KY484493_O._flava
&gt;KY484502_P._ramosa
&gt;KY484503_P._purpurea
</code></pre>
<p>Można oczywiście uzyskaną posortowaną listę nazw sekwencji do pliku:</p>
<pre><code>$: grep -v Lindenbergia Orobanchaceae-trnL-trnF-aligned.fasta | grep &quot;&gt;&quot; | sort &gt; posortowane.txt
</code></pre>
<p>Wykonaj powyższe polecenie i sprawdź zawartość pliku <code>posortowane.txt</code>.</p>
<a class="header" href="#xargs---przekazanie-argumentów-do-kolejnego-polecenia" id="xargs---przekazanie-argumentów-do-kolejnego-polecenia"><h2><code>xargs</code> - przekazanie argumentów do kolejnego polecenia</h2></a>
<p>Narzędzie <code>xargs</code> pozwala przekazać kolejnemu poleceniu argumenty otrzymane ze standardowego wejścia, czyli np. przez potok. Najłatwiej pokazać to na przykładzie:</p>
<pre><code>ls *.fasta | xargs cat &gt; wszystkie.fasta
</code></pre>
<p>Najpierw mamy polecenie <code>ls *fasta</code>, które zwraca listę plików o przedłużeniu <code>fasta</code> znajdujących się w bieżącym katalogu. Jest ona przekazywana przez potok do polecenia <code>xargs</code>, które przekazuje je poleceniu <code>cat</code> jako kolejne argumenty. Jak wiemy polecenie <code>cat</code> zwraca zawartość pliku, którego nazwa jest argumentem do standardowego wyjścia, którym może być ekran, ale w tym przypadku, przekierowujemy ją do pliku <code>wszystkie.fasta</code>. Tak więc całe polecenie umieszcza zawartość wszystkich plików <code>fasta</code> w pliku wynikowym. W tym przypadku można by było po prostu wykonać komendę:</p>
<pre><code>cat *.fasta &gt; wszystkie.fasta
</code></pre>
<p>ale jak się później przekonamy, nie zawsze tak łatwo jest pominąć <code>xargs</code> i program ten bywa bardzo pożyteczny.</p>
<a class="header" href="#sed---przetwarzanie-tekstu" id="sed---przetwarzanie-tekstu"><h2><code>sed</code> - przetwarzanie tekstu</h2></a>
<p>Kolejne bardzo użyteczne narzędzie to <code>sed</code>. Pozwala na edycję strumienia danych. Jedną z zalet używania tego typu programów jest możliwość uzyskiwania i modyfikacji danych z plików bez konieczności ich otwierania od razu w całości, jak to ma miejsce w edytorach tekstu. Nie mam to wielkiego znaczenia w przypadku niewielkich plików ale na przykład pliki uzyskiwane przy sekwencjonowaniu genomów mogą mieć wielkość wielu gigabajtów co w znacznym stopniu utrudnia pracę nad nimi w edytorach tekstu. Nawet jednak dla małych plików praca z linii komend może być po prostu znacznie szybsza.</p>
<p>Prosty schemat użycia <code>sed</code> wygląda tak:</p>
<pre><code>sed 's/szukany/zmieniony/g' plik
</code></pre>
<p>W pliku <code>plik</code> zmieniane są wszystkie ciągi znaków <code>szukany</code> na <code>zmieniony</code>. Bez opcji <code>g</code> (po trzecim ukośniku) zmienione zostanie tylko pierwsze wystąpienie szukanego ciągu w linii. Zamiast pliku można użyć strumienia danych z innych poleceń.</p>
<pre><code>$: echo &quot;ATCTTGGATCG&quot; | sed 's/T/U/g'
AUCUUGGAUCG
</code></pre>
<p>Kilka przykładów, wykorzystamy utworzony powyżej plik <code>posortowane.txt</code>, najpierw sprawdźmy co zawiera:</p>
<pre><code>$: more posortowane.txt 
&gt;KU238865_O._coerulescens
&gt;KY484464_O._teucrii
&gt;KY484471_O._kochii
&gt;KY484474_O._elatior
&gt;KY484489_O._mayeri
&gt;KY484493_O._flava
&gt;KY484502_P._ramosa
&gt;KY484503_P._purpurea
</code></pre>
<p>Zamiana znaków '_' na spacje:</p>
<pre><code>sed 's/_/ /g' posortowane.txt
&gt;KU238865 O. coerulescens
&gt;KY484464 O. teucrii
&gt;KY484471 O. kochii
&gt;KY484474 O. elatior
&gt;KY484489 O. mayeri
&gt;KY484493 O. flava
&gt;KY484502 P. ramosa
&gt;KY484503 P. purpurea
</code></pre>
<p>Usuwane znaku <code>&gt;</code>, ponieważ występuje on tylko raz w linii, opcja <code>g</code> jest zbędna:</p>
<pre><code>sed 's/&gt;//' posortowane.txt 
KU238865_O._coerulescens
KY484464_O._teucrii
KY484471_O._kochii
KY484474_O._elatior
KY484489_O._mayeri
KY484493_O._flava
KY484502_P._ramosa
KY484503_P._purpurea
</code></pre>
<p>Połączmy teraz dwa powyższe i zmieńmy skróty <code>P.</code> oraz <code>O.</code> na pełne nazwy rodzajowe:</p>
<pre><code>$: sed 's/&gt;//' posortowane.txt | sed 's/_/ /g' | sed 's/O\./Orobanche/' | sed 's/P\./Phelipanche/'

KU238865 Orobanche coerulescens
KY484464 Orobanche teucrii
KY484471 Orobanche kochii
KY484474 Orobanche elatior
KY484489 Orobanche mayeri
KY484493 Orobanche flava
KY484502 Phelipanche ramosa
KY484503 Phelipanche purpurea
</code></pre>
<p>Zauważ, że zamiast napisać <code>s/O./Orobanche/</code> napisałem <code>s/O\./Orobanche/</code>. Co prawda w tym przypadku oba warianty zwrócą taki sam wynik, ale sposób ich działania jest nieco odmienny, o czym za chwilę.</p>
<p>Wynik działania <code>sed</code> często chcemy zapisać w pliku. Można w tym celu użyć znaku <code>&gt;</code>:</p>
<pre><code>$: sed 's/&gt;//' posortowane.txt | sed 's/_/ /g' | sed 's/O\./Orobanche/' | sed 's/P\./Phelipanche/' &gt; zmieniony.txt
</code></pre>
<p>Teraz można wykonać polecenie:</p>
<pre><code>$: mv zmieniony.txt posortowane.txt
</code></pre>
<p>Jeśli chcemy bezpośrednio zmienić plik oryginalny, należy użyć opcji -i ale wtedy nie użyjemy potoków, możemy natomiast zgrupować formuły zmian razem oddzielając je średnikami (jeśli to nie działa spróbuj dodać opcję <code>-e</code>):</p>
<pre><code>sed -i 's/&gt;//;s/_/ /g;s/O\./Orobanche/;s/P\./Phelipanche/' posortowane.txt
</code></pre>
<p>Można też wykonać kolejno operacje:</p>
<pre><code>$: sed -i 's/&gt;//' posortowane.txt
$: sed -i 's/_/ /g' posortowane.txt
$: sed -i 's/O\./Orobanche/' posortowane.txt
$: sed -i 's/P\./Phelipanche/' posortowane.txt
</code></pre>
<p>Należy uważać ze zmianą oryginalnego pliku, lepiej najpierw sprawdzić czy wpisywana formuła edycji działa prawidłowo a dopiero później użyć opcji <code>-i</code>.</p>
<a class="header" href="#wyrażenia-regularne" id="wyrażenia-regularne"><h2>Wyrażenia regularne</h2></a>
<p>Wyrażenia regularne są bardzo użyteczne w bioinformatyce, ponieważ są potężnym narzędziem ułatwiającym pracę z plikami tekstowymi i strumieniami tekstu czy ogólniej z ciągami znaków. Dzięki nim można opisać z różnym stopniem ogólności ciągi znaków, czy ich kategorie aby później je wyświetlić, usunąć czy zmodyfikować. Wykorzystuje się je w takich narzędziach jak <code>grep</code>, <code>sed</code> i wielu innych z dobrymi edytorami tekstu włącznie (np. <code>vim</code>).</p>
<p>Przyjrzyjmy się ponownie zmodyfikowanemu plikowi <code>posortowane.txt</code>.</p>
<pre><code>$: more posortowane.txt 
KU238865 Orobanche coerulescens
KY484464 Orobanche teucrii
KY484471 Orobanche kochii
KY484474 Orobanche elatior
KY484489 Orobanche mayeri
KY484493 Orobanche flava
KY484502 Phelipanche ramosa
KY484503 Phelipanche purpurea
</code></pre>
<p>Przypuśćmy, że chcemy uzyskać jedynie listę organizmów, bez numerów GenBank-u. Można by je po kolei usuwać, ale znaczne wygodniej będzie użyć wyrażeń regularnych:</p>
<pre><code>$: sed 's/^[[:alnum:]]\+[[:space:]]//' posortowane.txt
Orobanche coerulescens
Orobanche teucrii
Orobanche kochii
Orobanche elatior
Orobanche mayeri
Orobanche flava
Phelipanche ramosa
Phelipanche purpurea
</code></pre>
<p>Zanim wyjaśnię jak i dlaczego to działa, trochę teorii.</p>
<p>W wyrażeniach regularnych możemy stosować znaki rozumiane dosłownie (litery, cyfry, spacje, niektóre inne znaki) oraz znaki specjalne (<code>$</code>, <code>*</code>, <code>.</code>, <code>[</code>, <code>\</code>, oraz <code>^</code>)i wyrażenia, które pozwalają na przykład opisać kategorie znaków, ich liczbę, położenie itp. Na przykład <code>ATG</code> oznacza ciąg <code>ATG</code> ale <code>[ATG]</code> oznacza <code>A</code> lub <code>T</code> lub <code>G</code>. Specjalne znaczenie ma znak <code>\</code>, który zmienia znaczenie następnego znaku - na przykład oznacza, że następujący po nim znak specjalny powinien być rozumiany dosłownie albo, że zwykły znak ma znaczenie specjalne.</p>
<p>W poniższej tabeli znajdują się <strong>niektóre</strong> przykłady:</p>
<table><thead><tr><th align="center"> <strong>Wyrażenie</strong>  </th><th align="left"> <strong>Znaczenie</strong> </th><th align="center"> <strong>Przykład</strong> </th><th align="left"> <strong>Znaczenie przykładu</strong> </th></tr></thead><tbody>
<tr><td align="center"> <code>*</code>        </td><td align="left"> zero lub więcej wystąpień wyrażenia </td><td align="center"> <code>T*</code> </td><td align="left"> zero lub więcej liter <code>T</code> </td></tr>
<tr><td align="center"> <code>\+</code>       </td><td align="left"> jedno lub więcej wystąpień wyrażenia </td><td align="center"> <code>T\+</code> </td><td align="left"> jedna lub więcej litera <code>T</code> </td></tr>
<tr><td align="center"> <code>\?</code>       </td><td align="left"> zero lub jedno wystąpień wyrażenia </td><td align="center"> <code>T\?</code> </td><td align="left"> zero lub jedna litera <code>T</code> </td></tr>
<tr><td align="center"> <code>\{i\}</code>    </td><td align="left"> dokładnie <code>i</code> wystąpień wyrażenia </td><td align="center"> <code>T\{3\}</code> </td><td align="left"> trzy znaki <code>T</code></td></tr>
<tr><td align="center"> <code>\{i,j\}</code>  </td><td align="left"> pomiędzy <code>i</code> a <code>j</code> wystąpień wyrażenia </td><td align="center"> <code>T\{3,5\}</code> </td><td align="left"> pomiędzy 3 a 5 znaków <code>T</code></td></tr>
<tr><td align="center"> <code>\{i,\}</code>   </td><td align="left"> <code>i</code> lub więcej wystąpień wyrażenia </td><td align="center"> <code>T\{3,\}</code> </td><td align="left"> przynajmniej 3 znaki <code>T</code></td></tr>
<tr><td align="center"> <code>.</code>        </td><td align="left"> jakikolwiek znak </td><td align="center"> <code>.\{3\}</code> </td><td align="left"> trzy dowolne znaki </td></tr>
<tr><td align="center"> <code>^</code>        </td><td align="left"> początek linii </td><td align="center"> <code>^T</code> </td><td align="left"> znak <code>T</code> występujący na początku linii </td></tr>
<tr><td align="center"> <code>$</code>        </td><td align="left"> koniec linii </td><td align="center"> <code>T$</code> </td><td align="left"> znak <code>T</code> na końcu linii </td></tr>
<tr><td align="center"> <code>[znaki]</code>  </td><td align="left"> jakikolwiek znak z zestawu znaków </td><td align="center"> <code>[TGA]</code> </td><td align="left"> <code>T</code> lub <code>G</code> lub <code>A</code> </td></tr>
<tr><td align="center"> <code>[x-y]</code>    </td><td align="left"> jakikolwiek znak z zakresu x do y (litery, cyfry)</td><td align="center"> <code>[A-Z]</code> </td><td align="left"> duża litera </td></tr>
<tr><td align="center">            </td><td align="left">          </td><td align="center"> <code>[a-z 0-9]</code> </td><td align="left"> mała litera lub cyfra </td><td> </td></tr>
<tr><td align="center"> <code>[^znaki]</code> </td><td align="left"> jakikolwiek znak z poza zestawu znaków </td><td align="center"> <code>[^TGA]</code> </td><td align="left"> jakikolwiek znak oprócz <code>T</code>, <code>G</code> i <code>A</code> </td></tr>
<tr><td align="center"> <code>\znak_specjalny</code> </td><td align="left"> znak specjalny (<code>$</code>, <code>*</code>, <code>.</code>, <code>[</code>, <code>\</code>, <code>^</code>) rozumiany dosłownie </td><td align="center"> <code>\^</code> </td><td align="left"> znak <code>^</code> (a nie początek linii) </td></tr>
<tr><td align="center"> <code>\(wyrażenie\)</code> </td><td align="left"> wyrażenie grupujące,  dopasowany łańcuch można później wykorzystać, np. wstawiając go w inne miejsce </td><td align="center"> </td><td align="left"> </td></tr>
<tr><td align="center"> <code>\n</code>       </td><td align="left"> znak nowej linii </td><td align="center">  </td><td align="left"> </td></tr>
<tr><td align="center"> <code>\t</code>       </td><td align="left"> znak tabulatora </td><td align="center">  </td><td align="left"> </td></tr>
<tr><td align="center"> <code>[[:alnum:]]</code> </td><td align="left"> znak alfanumeryczny (litery lub cyfry)  </td><td align="center">  </td><td align="left"> </td></tr>
<tr><td align="center"> <code>[[:alpha:]]</code> </td><td align="left"> litera </td><td align="center"> </td><td align="left"> </td></tr>
<tr><td align="center"> <code>[[:digit:]]</code> </td><td align="left"> cyfra </td><td align="center"> </td><td align="left"> </td></tr>
<tr><td align="center"> <code>[[:blank:]]</code> </td><td align="left"> spacja lub tabulator </td><td align="center"> </td><td align="left"> </td></tr>
<tr><td align="center"> <code>[[:space:]]</code> </td><td align="left"> znak odstępu (w tym nowej linii) </td><td align="center"> </td><td align="left"> </td></tr>
</tbody></table>
<p>Zauważ, że znaczenie znaku <code>^</code> zmienia się w zależności od kontekstu - oznacza on początek linii lub negację zakresu znaków.</p>
<p>Wróćmy teraz do pliku <code>posortowane.txt</code> i zastanówmy się jak można opisać numery GenBank-u?</p>
<pre><code>$: more posortowane.txt 
KU238865 Orobanche coerulescens
KY484464 Orobanche teucrii
KY484471 Orobanche kochii
KY484474 Orobanche elatior
KY484489 Orobanche mayeri
KY484493 Orobanche flava
KY484502 Phelipanche ramosa
KY484503 Phelipanche purpurea
</code></pre>
<p>Jest to ciąg znaków zaczynający się na początku linii, zawierający litery i cyfry (znali alfanumeryczne) po którym występuje spacja (jeden ze znaków odstępu).</p>
<p>Teraz poprzednio użyte wyrażenie powinno być bardziej zrozumiałe:</p>
<pre><code>$: sed 's/^[[:alnum:]]\+[[:space:]]//' posortowane.txt
</code></pre>
<p><code>^</code> początek linii <code>[[:alnum:]]\+</code> jeden lub więcej znaków alfanumerycznych <code>[[:space:]]</code> znak odstępu.</p>
<blockquote>
<p>Zadanie: Spróbuj usunąć numery GenBank-u używając innego wyrażenia.</p>
</blockquote>
<p>Po przejrzeniu powyższej tabeli powinno być jasne, dlaczego powyżej zamiast napisać <code>s/O./Orobanche/</code> napisałem <code>s/O\./Orobanche/</code>. Kropka oznacza jakikolwiek znak, ponieważ także oznacza kropkę oba wyrażenia zadziałają w tym przypadku (!) tak samo, ale jeśli chcemy być pewni, że dopasujemy znak <code>.</code>, to powinniśmy użyć przed niem znaku <code>\</code>, co spowoduje, że znak zostanie odczytany dosłownie.</p>
<p>Zamieszczone w tabeli wyrażenie <code>\(wyrażenie\)</code> zapewne wydaje się niejasne. Pokażę zatem na przykładzie jak może być wykorzystane. Tym razem zadaniem będzie przeniesienie numeru GenBank-u na koniec linii. Można to zrobić tak:</p>
<pre><code>$: sed 's/^\([[:alnum:]]\+[[:space:]]\)\(.*\)/\2 \1/' posortowane.txt
Orobanche coerulescens KU238865 
Orobanche teucrii KY484464 
Orobanche kochii KY484471 
Orobanche elatior KY484474 
Orobanche mayeri KY484489 
Orobanche flava KY484493 
Phelipanche ramosa KY484502 
Phelipanche purpurea KY484503
</code></pre>
<p>Powyżej wykorzystałem dwa wyrażenia grupujące. Pierwszy z nich obejmuje dopasowanie numeru GenBank-u (oraz spację), drugie pozostałą część tekstu (<code>.*</code> oznacza zero lub więcej dowolnych znaków. Po drugim ukośniku odwołuję się do wcześniej znalezionych dopasowań: <code>\1</code> oznacza pierwsze dopasowanie, <code>\2</code> drugie dopasowanie. Umieszczając je w kolejności <code>\2 \1</code> umieściłem pierwsze dopasowanie po drugim.</p>
<p>Zamianę można ograniczyć do linii, w których znajduje się inne dopasowanie. Na przykład:</p>
<pre><code>$: sed &quot;/^&gt;/ s/A/0/g&quot; plik.fasta
</code></pre>
<p>Zamieni znaki <code>A</code> na <code>0</code> w liniach, które zaczynają się od <code>&gt;</code>.</p>
<p>Z kolei polecenie:</p>
<pre><code>$: sed &quot;/^&gt;/! s/A/0/g&quot; plik.fasta
</code></pre>
<p>Dokona zamiany w liniach, które <strong>nie</strong> rozpoczynają się od <code>&gt;</code>.</p>
<p>Jeśli przed <code>s</code> w poleceniu umieścimy liczbę, będzie się ono odnosiło do linii w pliku o podanym numerze. Możemy np. w ten sposób dodać tekst w pierwszej linii w pliku <code>plik.txt</code>:</p>
<pre><code>sed -i &quot;1s/^/Tytuł dzieła\n/&quot; plik.txt
</code></pre>
<p>Aby usunąć linie, w których znajduje się dany wzorzec stosujemy następującą komendę:</p>
<pre><code>sed '/wzorzec/d' plik
</code></pre>
<p>Na przykład poniższa komenda usunie wszystkie linie z opisami sekwencji z pliku <code>sekwencje.fasta</code></p>
<pre><code>sed -i '/^&gt;/d' sekwencje.fasta
</code></pre>
<a class="header" href="#tr---zmiana-i-usuwanie-znaków" id="tr---zmiana-i-usuwanie-znaków"><h2><code>tr</code> - zmiana i usuwanie znaków</h2></a>
<p>Program <code>tr</code> ma podobne zastosowanie do <code>sed</code>-a, specjalizuje się jednak w zamianie pojedynczych znaków.</p>
<p>Używamy go w ten sposób:</p>
<pre><code>tr opcje znaki1 znaki2
</code></pre>
<p><code>znaki1</code> - to zestaw znaków które zmieniamy
<code>znaki2</code> - to zestaw znaków na które zmieniamy</p>
<p>Pokażę to na kilku przykładach.</p>
<p>Zamiana <code>*</code> na <code>-</code></p>
<pre><code>$: echo &quot;AGGC*TT&quot; | tr &quot;*&quot; &quot;-&quot;

AGGC-TT
</code></pre>
<p>Usunięcie znaków <code>-</code>. Tak można łatwo usunąć z sekwencji znaki oznaczające indele.</p>
<pre><code>$: echo &quot;AG--GC-TT&quot; | tr -d &quot;-&quot;

AGGCTT
</code></pre>
<p>Zamiana <code>A</code> na <code>T</code>, <code>C</code> na <code>G</code>, <code>G</code> na <code>C</code> oraz <code>T</code> na <code>A</code>.</p>
<pre><code>$: echo &quot;AGGCTT&quot; | tr &quot;ACGT&quot; &quot;TGCA&quot; 

TCCGAA
</code></pre>
<p>W ten sposób można otrzymać łatwo sekwencję komplementarną.
Zauważ, że powyższa komenda nie zmienia sekwencji <code>ACGT</code> na <code>TGCA</code>, ale podmienia poszczególne znaki.</p>
<p><code>tr</code> nie ma możliwości bezpośredniej modyfikacji pliku, dlatego jeśli chcemy zmienić plik, użyjemy znaków przekierowania <code>&lt;</code> do pliku wejściowego i <code>&gt;</code> dla pliku wyjściowego.</p>
<p>Utwórz plik <code>sekwencje.txt</code> o zawartości:</p>
<pre><code>CGACCAGATTACGGGGCCCATTA
CGAGACATTTATATACGATATAG
AAATTTCGCGCGCAGATAGCATA
</code></pre>
<p>Teraz utworzymy dla tych krótkich sekwencji sekwencje komplementarne:</p>
<pre><code>tr &quot;ACGT&quot; &quot;TGCA&quot; &lt; sekwencje.txt &gt; sekwencje_komplementarne.txt
</code></pre>
<p>albo</p>
<pre><code>cat sekwencje.txt | tr &quot;ACGT&quot; &quot;TGCA&quot; &gt; sekwencje_komplementarne.txt
</code></pre>
<p>Otrzymujemy plik <code>sekwencje_komplementarne.txt</code>:</p>
<pre><code>GCTGGTCTAATGCCCCGGGTAAT
GCTCTGTAAATATATGCTATATC
TTTAAAGCGCGCGTCTATCGTAT
</code></pre>
<p>Teraz połączmy te sekwencje w jedną, długą. W tym celu usuniemy <code>\n</code> oznaczający znak nowej linii.</p>
<pre><code>tr -d &quot;\n&quot; &lt; sekwencje_komplementarne.txt &gt; polaczona_sekwencja_komplementarna.txt
</code></pre>
<p>Tu też oczywiście można też użyć komendy <code>cat</code> i znaku <code>|</code>:</p>
<pre><code>cat sekwencje_komplementarne.txt| tr -d &quot;\n&quot; &gt; polaczona_sekwencja_komplementarna.txt
</code></pre>
<p>Plik wynikowy, zgodnie z założeniem, posiada jedną długą sekwencję:</p>
<pre><code>GCTGGTCTAATGCCCCGGGTAATGCTCTGTAAATATATGCTATATCTTTAAAGCGCGCGTCTATCGTAT
</code></pre>
<a class="header" href="#rev---odwracanie-łańcucha-znaków" id="rev---odwracanie-łańcucha-znaków"><h2><code>rev</code> - odwracanie łańcucha znaków</h2></a>
<p>Bardzo prostym, ale użytecznym narzędziem jest <code>rev</code> (od <em>reverse</em>), który odwraca łańcuch znaków.</p>
<pre><code>$: echo &quot;ACGTTT&quot; | rev

TTTGCA
</code></pre>
<p>Teraz można sekwencję w pliku <code>polaczona_sekwencja_komplementarna.txt</code> także odwrócić. W efekcie otrzymamy sekwencję komplementarną, odwróconą.</p>
<pre><code>cat polaczona_sekwencja_komplementarna.txt | rev &gt; polaczona_sekwencja_komplementarna_odwrocona.txt
</code></pre>
<p>Cały proces łączenia przekształcania sekwencji w odwróconą i komplementarną można zmieścić w ,,jednolinijkowcu'' używając potoków i przekierowania:</p>
<pre><code>cat sekwencja.txt | tr &quot;ACGT&quot; &quot;TGCA&quot; | tr -d &quot;\n&quot; | rev &gt; sekwencja_RC.txt
</code></pre>
<a class="header" href="#uniq---usuwanie-powtórzeń" id="uniq---usuwanie-powtórzeń"><h2><code>uniq</code> - usuwanie powtórzeń</h2></a>
<p>Polecenie <code>uniq</code> pozwala na usuwanie powtarzających się linii. Na przykład chcielibyśmy otrzymać listę rodzajów z taksonów znajdujących się w pliku <code>fasta</code> ale tak, aby każda nazwa występowała tylko raz.</p>
<p>Pobierz plik:</p>
<pre><code>http://ggoralski.pl/files/filogenetyka-data/atp6-samples.fasta
</code></pre>
<p>Najpierw uzyskajmy opisy sekwencji:</p>
<pre><code>$: grep &quot;&gt;&quot; atp6-samples.fasta 
&gt;KY492922.1 Dendropicos elliotii isolate DA07 ATP6 (ATP6) gene, partial cds; mitochondrial
&gt;KY492921.1 Dendropicos stierlingi isolate ZMUC74329 ATP6 (ATP6) gene, complete cds; mitochondrial
&gt;KY492920.1 Dendropicos poecilolaemus isolate ZMUC72915 ATP6 (ATP6) gene, complete cds; mitochondrial
&gt;KY492919.1 Campethera punctuligera isolate ZMUC56174 ATP6 (ATP6) gene, complete cds; mitochondrial
&gt;KY492918.1 Campethera cailliautii isolate ZMUC56172 ATP6 (ATP6) gene, complete cds; mitochondrial
&gt;KY492917.1 Dendropicos fuscescens isolate Z34 ATP6 (ATP6) gene, complete cds; mitochondrial
&gt;KY492916.1 Campethera cailliautii isolate W45 ATP6 (ATP6) gene, complete cds; mitochondrial
&gt;KY492915.1 Chloropicus xantholophus isolate MNHN2005922 ATP6 (ATP6) gene, complete cds; mitochondrial
....
</code></pre>
<p>Jak widać opisy są nieco bardziej złożone niż w poprzednio używanym pliku, ponadto jest ich więcej (powyżej widać tylko początek listy).</p>
<p>Teraz trzeba wyodrębnić nazwy rodzajowe. W naszym pliku jest to drugi ciąg znaków alfanumerycznych. Zastanów się jak go uzyskać?</p>
<pre><code>$: grep &quot;&gt;&quot; atp6-samples.fasta | sed 's/\(^&gt;[[:alnum:]]\+\.[[:digit:]][[:space:]]\)\([[:alnum:]]\+\)\([[:space:]].\+\)/\2/' 
Dendropicos
Dendropicos
Dendropicos
Campethera
Campethera
Dendropicos
Campethera
Chloropicus
Campethera
Dendropicos
...
</code></pre>
<p>Tym razem wykorzystałem trzy wyrażenia grupujące: pierwszy oznacza numer GenBank-u (znali alfanumeryczne, kropka, cyfra) ze spacją, drugi znajduje ciąg znaków alfanumerycznych odpowiadających nazwie rodzajowej a trzeci grupuje pozostałe znaki w linii. Jak widać wykorzystujemy w dalszej części polecenia tylko drugie dopasowanie co powoduje, że zwracana jest tylko nazwa rodzajowa.
Szkopuł w tym, że nazwy te wyświetlają się wielokrotnie, a chcielibyśmy mieć listę rodzajów, taką w której każda występowałaby tylko raz. Dodajmy zatem polecenie <code>uniq</code>:</p>
<pre><code>$: grep &quot;&gt;&quot; atp6-samples.fasta | sed 's/\(^&gt;[[:alnum:]]\+\.[[:digit:]][[:space:]]\)\([[:alnum:]]\+\)\([[:space:]].\+\)/\2/' | uniq
Dendropicos
Campethera
Dendropicos
Campethera
Chloropicus
Campethera
Dendropicos
Campethera
Ipophilus
...
</code></pre>
<p>Efekt jest nie do końca zgodny z oczekiwaniami. Co prawda duplikaty zostały usunięte, ale tylko wtedy gdy znajdowały się bezpośrednio po sobie. Tak właśnie działa <code>uniq</code>. Wykorzystajmy zatem polecenie, które sortuje linie, czyli <code>sort</code>  wtedy wszystkie takie same linie znajdą się bezpośrednio przy sobie.</p>
<pre><code>$: grep &quot;&gt;&quot; atp6-samples.fasta | sed 's/\(^&gt;[[:alnum:]]\+\.[[:digit:]][[:space:]]\)\([[:alnum:]]\+\)\([[:space:]].\+\)/\2/' | sort | uniq
Campethera
Chloropicus
Cooperia
Dendropicos
Ipophilus
Paracoccidioides
Pocillopora
</code></pre>
<blockquote>
<p>Zadanie: policz ile sekwencji i ile różnych nazw rodzajowych znajduje się w pliku</p>
</blockquote>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="../cwiczenia/11-praca_w_linuksie.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="../cwiczenia/13-edytory_tekstu.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a href="../cwiczenia/11-praca_w_linuksie.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a href="../cwiczenia/13-edytory_tekstu.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        
        <!-- Livereload script (if served using the cli tool) -->
        <script type="text/javascript">
            var socket = new WebSocket("ws://localhost:3001");
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload(true); // force reload from server (not from cache)
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>
        

        

        

        
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        

    </body>
</html>
